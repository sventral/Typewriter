<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Typewriter</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="app-version">v.4.3b</div>
  <div class="ruler" id="rulerH_host">
    <div class="ruler-ticks"></div>
    <div id="rulerH_stops_container"></div>
  </div>
  <div class="ruler-v" id="rulerV_host">
    <div class="ruler-v-ticks"></div>
    <div id="rulerV_stops_container"></div>
  </div>

  <div class="zoom-controls" id="zoomControls">
    <div class="slider" id="zoomSlider">
      <div class="track" id="zoomTrack">
        <div class="fill" id="zoomFill"></div>
      </div>
      <div class="thumb" id="zoomThumb" aria-label="Zoom handle" title="Zoom 50–400%"></div>
    </div>
    <div id="zoomIndicator">100%</div>
  </div>

  <div id="stage" class="stage" tabindex="-1">
    <div class="zoom-wrap" id="zoomWrap">
      <div class="stage-inner" id="stageInner">
        <div class="page-wrap" data-page="0">
          <div id="page" class="page">
            <canvas></canvas>
            <div id="marginBox" class="margin-box"></div>
            <div id="caret" class="caret"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="guideV" class="guide"></div>
  <div id="guideH" class="guide"></div>

  <div class="toolbar">
    <div class="toolbar-left">
      <button class="btn" id="settingsBtnNew">Settings</button>
      <div class="doc-controls" id="docControls">
        <button class="btn icon-only" id="docMenuBtn" aria-haspopup="true" aria-expanded="false" title="Documents" aria-label="Documents">
          <svg class="icon" viewBox="0 0 20 20" focusable="false" aria-hidden="true">
            <path d="M4 5.25a.75.75 0 0 1 .75-.75h10.5a.75.75 0 0 1 0 1.5H4.75A.75.75 0 0 1 4 5.25Zm0 4a.75.75 0 0 1 .75-.75h10.5a.75.75 0 0 1 0 1.5H4.75A.75.75 0 0 1 4 9.25Zm0 4a.75.75 0 0 1 .75-.75h10.5a.75.75 0 0 1 0 1.5H4.75A.75.75 0 0 1 4 13.25Z" fill="currentColor" />
          </svg>
        </button>
        <input class="doc-title-input" id="docTitleInput" type="text" maxlength="200" placeholder="Untitled Document" aria-label="Document title" />
        <div class="doc-menu-popup" id="docMenuPopup" role="menu" aria-labelledby="docMenuBtn">
          <div class="doc-menu-header">Documents</div>
          <div class="doc-menu-list" id="docMenuList"></div>
        </div>
      </div>
      <button class="btn icon-only" id="deleteDocBtn" title="Delete document" aria-label="Delete document">
        <svg class="icon" viewBox="0 0 20 20" focusable="false" aria-hidden="true">
          <path d="M7.25 3a1 1 0 0 1 .97-.75h3.56a1 1 0 0 1 .97.75l.3 1.25h3.75a.75.75 0 0 1 0 1.5h-.7l-.73 10.01A2.25 2.25 0 0 1 12.13 18H7.87a2.25 2.25 0 0 1-2.24-2.24L4.9 5.75h-.65a.75.75 0 0 1 0-1.5h3.75ZM6.4 5.75l.7 9.72c.05.4.38.7.77.7h4.26c.4 0 .73-.3.77-.7l.7-9.72H6.4Zm3.1 2a.75.75 0 0 1 .75.75v4.5a.75.75 0 0 1-1.5 0v-4.5a.75.75 0 0 1 .75-.75Z" fill="currentColor" />
        </svg>
      </button>
      <button class="btn icon-only" id="newDocBtn" title="New document" aria-label="New document">
        <svg class="icon" viewBox="0 0 20 20" focusable="false" aria-hidden="true">
          <path d="M10 3a.75.75 0 0 1 .75.75v5.5h5.5a.75.75 0 0 1 0 1.5h-5.5v5.5a.75.75 0 0 1-1.5 0v-5.5h-5.5a.75.75 0 0 1 0-1.5h5.5v-5.5A.75.75 0 0 1 10 3Z" fill="currentColor" />
        </svg>
      </button>
      <button class="btn" id="exportTxtBtn">Export</button>
    </div>
    <div class="toolbar-right">
      <button class="btn" id="inkSettingsBtn">Ink settings</button>
      <button class="btn" id="toggleMarginsBtn" title="Toggle rulers">Margins</button>
      <button class="btn" id="fontsBtn">Fonts</button>
      <div class="ink-control-group">
        <button class="btn" id="inkBlackBtn" title="Black Ink. Long-press for transparency."><span class="sw black"></span></button>
        <div class="ink-slider-popup" id="inkBlackSliderPopup">
          <div class="slider-container">
            <input type="range" id="inkOpacityBSlider" min="0" max="100" step="1" value="100" class="ink-slider">
          </div>
          <span class="slider-value" id="inkOpacityBValue">100%</span>
        </div>
      </div>
      <div class="ink-control-group">
        <button class="btn" id="inkRedBtn" title="Red Ink. Long-press for transparency."><span class="sw red"></span></button>
        <div class="ink-slider-popup" id="inkRedSliderPopup">
          <div class="slider-container">
            <input type="range" id="inkOpacityRSlider" min="0" max="100" step="1" value="100" class="ink-slider">
          </div>
          <span class="slider-value" id="inkOpacityRValue">100%</span>
        </div>
      </div>
      <div class="ink-control-group">
        <button class="btn" id="inkWhiteBtn" title="White Ink (Eraser). Long-press for transparency."><span class="sw white"></span></button>
        <div class="ink-slider-popup" id="inkWhiteSliderPopup">
          <div class="slider-container">
            <input type="range" id="inkOpacityWSlider" min="0" max="100" step="1" value="100" class="ink-slider">
          </div>
          <span class="slider-value" id="inkOpacityWValue">100%</span>
        </div>
      </div>
    </div>
  </div>

  <aside id="inkSettingsPanel" class="side-panel from-right">
    <div class="panel-content ink-settings-content">
      <h3>Ink Settings</h3>
      <div class="settings-group-new">
        <div class="control-row ink-overall-row">
          <label for="inkOverallStrength">Overall Strength (%)</label>
          <div class="ink-inline-controls">
            <input type="number" id="inkOverallStrength" min="0" max="100" step="1" value="100" />
            <button class="btn apply-btn" id="inkOverallApplyBtn">Apply</button>
          </div>
        </div>
      </div>
      <div id="inkSettingsSections"></div>
      <div class="control-row ink-copy-row">
        <div></div>
        <button class="btn apply-btn" id="inkSettingsCopyBtn">Copy</button>
      </div>
    </div>
  </aside>

  <aside id="settingsPanel" class="side-panel from-left">
    <div class="panel-content">
      <h3>Ink Effects</h3>
      <div class="settings-group-new">
        <div class="control-row">
          <label for="grainPct">Grain</label>
          <input type="number" id="grainPct" min="0" max="100" step="1" value="0" title="Grain strength (0–100)">
        </div>
      </div>
      <hr class="divider">
      <h3>Typography</h3>
      <div class="settings-group-new">
        <div class="control-row">
          <label for="cpiSelect">CPI</label>
          <select id="cpiSelect">
            <option value="10">10</option>
            <option value="12">12</option>
          </select>
        </div>
        <div class="control-row">
          <label>Columns</label>
          <span id="colsPreview">Columns: 82.68</span>
        </div>
        <div class="control-row">
          <label for="sizeInput">Size</label>
          <div class="input-with-suffix">
            <input id="sizeInput" type="number" step="1" min="1" max="150" inputmode="numeric" pattern="[0-9]*" value="84" />
            <span>%</span>
          </div>
        </div>
        <div class="control-row">
          <div></div>
          <button class="btn apply-btn" id="applyBtn" title="Apply CPI & size">Apply</button>
        </div>
        <div class="control-row">
          <label for="lhInput">Line Height</label>
          <input id="lhInput" type="number" step="0.5" min="1" max="3" value="1" />
        </div>
        <div class="control-row">
          <div></div>
          <button class="btn apply-btn" id="applyLHBtn" title="Apply line height">Apply</button>
        </div>
      </div>
      <hr class="divider">
      <h3>Stage Bounds</h3>
      <div class="settings-group-new">
        <div class="control-row">
          <label for="stageWidthPct">Horizontal (%)</label>
          <input id="stageWidthPct" type="number" min="100" max="500" step="10" value="200" title="Stage width as % of page width" />
        </div>
        <div class="control-row">
          <label for="stageHeightPct">Vertical (%)</label>
          <input id="stageHeightPct" type="number" min="100" max="500" step="10" value="120" title="Stage height as % of page height" />
        </div>
      </div>
      <hr class="divider">
      <h3>Margins</h3>
      <div class="settings-group-new">
        <div class="control-row">
          <label for="mmLeft">Left (mm)</label>
          <input id="mmLeft" type="number" step="1" min="0" value="20" />
        </div>
        <div class="control-row">
          <label for="mmRight">Right (mm)</label>
          <input id="mmRight" type="number" step="1" min="0" value="20" />
        </div>
        <div class="control-row">
          <label for="mmTop">Top (mm)</label>
          <input id="mmTop" type="number" step="1" min="0" value="20" />
        </div>
        <div class="control-row">
          <label for="mmBottom">Bottom (mm)</label>
          <input id="mmBottom" type="number" step="1" min="0" value="20" />
        </div>
        <div class="control-row">
          <label for="showMarginBoxCb">Margin Box</label>
          <input id="showMarginBoxCb" type="checkbox" />
        </div>
        <div class="control-row">
          <label for="wordWrapCb">Word Wrap</label>
          <input id="wordWrapCb" type="checkbox" checked />
        </div>
      </div>
      <hr class="divider">
      <h3>Appearance</h3>
      <div class="settings-group-new appearance-group">
        <div class="appearance-options">
          <label>
            <input type="radio" name="appearanceMode" id="appearanceAuto" value="auto" checked />
            <span>Automatic</span>
          </label>
          <label>
            <input type="radio" name="appearanceMode" id="appearanceLight" value="light" />
            <span>Light</span>
          </label>
          <label>
            <input type="radio" name="appearanceMode" id="appearanceDark" value="dark" />
            <span>Dark</span>
          </label>
        </div>
        <label class="appearance-dark-toggle">
          <input type="checkbox" id="darkPageToggle" />
          <span>Dark page while in dark mode</span>
        </label>
      </div>
    </div>
  </aside>

  <aside id="fontsPanel" class="side-panel from-right">
    <div class="panel-content">
      <h3>Fonts</h3>
      <div class="settings-group-new">
        <label class="font-option">
          <div class="font-option-header">
            <input type="radio" name="fontChoice" value="TT2020Base" />
            <span class="font-name">TT2020 Base</span>
          </div>
          <span class="font-sample" style='font-family:"TT2020Base", Courier, "Courier New", monospace;'>The quick brown fox 123456</span>
        </label>
        <label class="font-option">
          <div class="font-option-header">
            <input type="radio" name="fontChoice" value="TT2020StyleB" />
            <span class="font-name">TT2020 Style B</span>
          </div>
          <span class="font-sample" style='font-family:"TT2020StyleB", Courier, "Courier New", monospace;'>The quick brown fox 123456</span>
        </label>
        <label class="font-option">
          <div class="font-option-header">
            <input type="radio" name="fontChoice" value="TT2020StyleD" />
            <span class="font-name">TT2020 Style D</span>
          </div>
          <span class="font-sample" style='font-family:"TT2020StyleD", Courier, "Courier New", monospace;'>The quick brown fox 123456</span>
        </label>
        <label class="font-option">
          <div class="font-option-header">
            <input type="radio" name="fontChoice" value="TT2020StyleE" checked />
            <span class="font-name">TT2020 Style E</span>
          </div>
          <span class="font-sample" style='font-family:"TT2020StyleE", Courier, "Courier New", monospace;'>The quick brown fox 123456</span>
        </label>
        <label class="font-option">
          <div class="font-option-header">
            <input type="radio" name="fontChoice" value="TT2020StyleF" />
            <span class="font-name">TT2020 Style F</span>
          </div>
          <span class="font-sample" style='font-family:"TT2020StyleF", Courier, "Courier New", monospace;'>The quick brown fox 123456</span>
        </label>
        <label class="font-option">
          <div class="font-option-header">
            <input type="radio" name="fontChoice" value="TT2020StyleG" />
            <span class="font-name">TT2020 Style G</span>
          </div>
          <span class="font-sample" style='font-family:"TT2020StyleG", Courier, "Courier New", monospace;'>The quick brown fox 123456</span>
        </label>
        <label class="font-option">
          <div class="font-option-header">
            <input type="radio" name="fontChoice" value="Courier New" />
            <span class="font-name">Courier New</span>
          </div>
          <span class="font-sample" style='font-family:"Courier New", monospace;'>The quick brown fox 123456</span>
        </label>
        <label class="font-option">
          <div class="font-option-header">
            <input type="radio" name="fontChoice" value="Courier" />
            <span class="font-name">Courier</span>
          </div>
          <span class="font-sample" style='font-family:Courier, "Courier New", monospace;'>The quick brown fox 123456</span>
        </label>
      </div>
    </div>
  </aside>

  <script type="module" src="js/main.js"></script>
</body>
</html>
