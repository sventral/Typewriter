:root{
    --page-w: 900;
    --page-width-px: calc(var(--page-w) * 1px);
    --page-height-px: calc(var(--page-width-px) * 297 / 210);
    --stage-width-mult: 2;
    --stage-height-mult: 1.2;
    --stage-width-px: calc(var(--page-width-px) * var(--stage-width-mult));
    --stage-height-px: calc(var(--page-height-px) * var(--stage-height-mult));
    --stage-bg-light:#d1d1d3;
    --stage-bg-dark:#343639;
    --page-bg-light:#ffffff;
    --page-bg-dark:#1f2024;
    --ui:#ffffff;
    --ui-border:#d0d0d0;
    --ui-text:#1f1f1f;
    --stage-bg:var(--stage-bg-light);
    --page-bg:var(--page-bg-light);
    --btn-bg:#f4f4f4;
    --btn-fg:#1f1f1f;
    --btn-border:#c6c6c6;
    --btn-hover:#ededed;
    --btn-active:#e6e6e6;
    --ruler-bg: rgba(255,255,255,0.4);
    --ruler-tick: rgba(0,0,0,0.55);
    --tri-color:#5c5c5c;
    --tri-red:#b00000;
    --toolbar-h:48px;
    --tri-h:12px;
    --panel-bg: rgba(247, 247, 247, 0.85);
    --panel-border: rgba(0, 0, 0, 0.1);
    --panel-item-bg: rgba(255, 255, 255, 0.7);
    --control-bg: #fff;
    --control-border: #ccc;
    --divider-color: #e0e0e0;
    --caret-color:#111111;
    --active-outline:#8aa2ff;
    --accent-color:#556cd6;
    --danger-color:#c24040;
    --danger-hover:#a83232;
    --danger-border:#c24141;
    --page-shadow:0 8px 24px rgba(0,0,0,0.10);
  }

:root[data-theme='light']{
    --ui:#ffffff;
    --ui-border:#d0d0d0;
    --ui-text:#1f1f1f;
    --stage-bg:var(--stage-bg-light);
    --page-bg:var(--page-bg-light);
    --btn-bg:#f4f4f4;
    --btn-fg:#1f1f1f;
    --btn-border:#c6c6c6;
    --btn-hover:#ededed;
    --btn-active:#e6e6e6;
    --ruler-bg: rgba(255,255,255,0.4);
    --ruler-tick: rgba(0,0,0,0.55);
    --tri-color:#5c5c5c;
    --tri-red:#b00000;
    --panel-bg: rgba(247, 247, 247, 0.85);
    --panel-item-bg: rgba(255, 255, 255, 0.7);
    --panel-border: rgba(0, 0, 0, 0.1);
    --control-bg: #fff;
    --control-border: #ccc;
    --divider-color: #e0e0e0;
    --caret-color:#111111;
    --active-outline:#8aa2ff;
    --accent-color:#556cd6;
    --danger-color:#c24040;
    --danger-hover:#a83232;
    --danger-border:#c24141;
    --page-shadow:0 8px 24px rgba(0,0,0,0.10);
}

@media (prefers-color-scheme: dark){
    :root:not([data-theme]){
      --ui:#1e1e21;
      --ui-border:#2d2d32;
      --ui-text:#ececec;
      --stage-bg:var(--stage-bg-dark);
      --page-bg:var(--page-bg-light);
      --btn-bg:#2a2b30;
      --btn-fg:#e6e6e6;
      --btn-border:#3a3b42;
      --btn-hover:#32333a;
      --btn-active:#2a2b31;
      --ruler-bg: rgba(18,18,20,0.65);
      --ruler-tick: rgba(237,237,242,0.65);
      --tri-color:#d7d7dc;
      --tri-red:#e47a7a;
      --panel-bg: rgba(44, 44, 50, 0.9);
      --panel-item-bg: rgba(60, 60, 68, 0.7);
      --panel-border: rgba(255, 255, 255, 0.12);
      --control-bg: #25262b;
      --control-border: #3f4047;
      --divider-color: #3f4047;
      --caret-color:#111111;
      --active-outline:#9ca3b5;
      --accent-color:#9ca3ff;
      --danger-color:#ff6b6b;
      --danger-hover:#ff8787;
      --danger-border:#ff8787;
      --page-shadow:0 14px 36px rgba(0,0,0,0.55);
    }
}

:root[data-theme='dark']{
    --ui:#1e1e21;
    --ui-border:#2d2d32;
    --ui-text:#ececec;
    --stage-bg:var(--stage-bg-dark);
    --page-bg:var(--page-bg-light);
    --btn-bg:#2a2b30;
    --btn-fg:#e6e6e6;
    --btn-border:#3a3b42;
    --btn-hover:#32333a;
    --btn-active:#2a2b31;
    --ruler-bg: rgba(18,18,20,0.65);
    --ruler-tick: rgba(237,237,242,0.65);
    --tri-color:#d7d7dc;
    --tri-red:#e47a7a;
    --panel-bg: rgba(44, 44, 50, 0.9);
    --panel-item-bg: rgba(60, 60, 68, 0.7);
    --panel-border: rgba(255, 255, 255, 0.12);
    --control-bg: #25262b;
    --control-border: #3f4047;
    --divider-color: #3f4047;
    --caret-color:#111111;
    --active-outline:#9ca3b5;
    --accent-color:#9ca3ff;
    --danger-color:#ff6b6b;
    --danger-hover:#ff8787;
    --danger-border:#ff8787;
    --page-shadow:0 14px 36px rgba(0,0,0,0.55);
}

body[data-page-tone='dark']{
    --page-bg:var(--page-bg-dark);
    --page-shadow:none;
    --caret-color:#f5f5f5;
}

@font-face{ font-family: "TT2020Base"; src: url("./fonts/TT2020Base-Regular.woff2") format("woff2"); font-weight: 400; font-style: normal; font-display: swap; }
@font-face{ font-family: "TT2020StyleB"; src: url("./fonts/TT2020StyleB-Regular.woff2") format("woff2"); font-weight: 400; font-style: normal; font-display: swap; }
@font-face{ font-family: "TT2020StyleD"; src: url("./fonts/TT2020StyleD-Regular.woff2") format("woff2"); font-weight: 400; font-style: normal; font-display: swap; }
@font-face{ font-family: "TT2020StyleE"; src: url("./fonts/TT2020StyleE-Regular.woff2") format("woff2"); font-weight: 400; font-style: normal; font-display: swap; }
@font-face{ font-family: "TT2020StyleF"; src: url("./fonts/TT2020StyleF-Regular.woff2") format("woff2"); font-weight: 400; font-style: normal; font-display: swap; }
@font-face{ font-family: "TT2020StyleG"; src: url("./fonts/TT2020StyleG-Regular.woff2") format("woff2"); font-weight: 400; font-style: normal; font-display: swap; }

  html,body{margin:0;height:100%;background:var(--stage-bg);font:16px system-ui, -apple-system, sans-serif;color:var(--ui-text)}

  .toolbar{
    box-sizing:border-box; position:fixed; left:0; right:0; bottom:0; height:var(--toolbar-h);
    z-index:51; display:flex; align-items:center; justify-content: space-between;
    padding:.6rem .8rem; background:var(--ui); color:var(--ui-text);
    border-top:1px solid var(--ui-border);
  }
  .toolbar-left, .toolbar-right { display:flex; align-items:center; gap:.5rem; }

  .btn.icon-only {
    padding: 0;
    min-width: 30px;
    width: 30px;
  }

  .btn.icon-only .icon {
    width: 18px;
    height: 18px;
  }

  .doc-controls {
    position: relative;
    display: flex;
    align-items: center;
    gap: .35rem;
  }

  .doc-title-input {
    box-sizing: border-box;
    height: 30px;
    padding: .25rem .5rem;
    border-radius: 6px;
    border: 1px solid var(--btn-border);
    background: var(--btn-bg);
    color: var(--btn-fg);
    width: clamp(160px, 18vw, 240px);
    font-size: 14px;
  }

  .doc-title-input:focus {
    outline: 2px solid var(--active-outline);
    outline-offset: 1px;
  }

  .doc-menu-popup {
    position: absolute;
    bottom: calc(100% + 8px);
    left: 0;
    width: 100%;
    max-height: 240px;
    display: none;
    flex-direction: column;
    background: var(--panel-bg);
    border: 1px solid var(--panel-border);
    border-radius: 10px;
    box-shadow: 0 10px 24px rgba(0,0,0,0.2);
    z-index: 90;
    overflow: hidden;
    min-width: 220px;
  }

  .doc-menu-popup.open {
    display: flex;
  }

  .doc-menu-header {
    padding: .5rem .75rem;
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: .08em;
    opacity: .7;
  }

  .doc-menu-list {
    display: flex;
    flex-direction: column;
    overflow-y: auto;
  }

  .doc-menu-empty {
    padding: .75rem;
    font-size: 13px;
    opacity: .6;
  }

  .doc-list-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: .75rem;
    padding: .55rem .75rem;
    background: transparent;
    border: none;
    border-top: 1px solid rgba(255,255,255,0.04);
    color: inherit;
    text-align: left;
    font-size: 13px;
    cursor: pointer;
  }

  .doc-list-item:first-of-type {
    border-top: none;
  }

  .doc-list-item:hover,
  .doc-list-item:focus {
    background: rgba(120, 120, 128, 0.18);
  }

  .doc-list-item.is-active {
    background: rgba(120, 120, 128, 0.24);
    font-weight: 600;
  }

  .doc-list-item .doc-updated {
    font-size: 11px;
    opacity: .55;
    margin-left: auto;
  }

  .btn{
    box-sizing:border-box; border:1px solid var(--btn-border);
    background:var(--btn-bg); color:var(--btn-fg); padding:.2rem .6rem;
    border-radius:6px; cursor:pointer; display:flex; align-items:center; justify-content:center;
    line-height:1.2rem; font-weight:500; min-width:36px; height:30px;
    font-size: 14px;
    -webkit-user-select: none; user-select: none;
  }
  .btn:hover{ background:var(--btn-hover) } .btn:active{ background:var(--btn-active) }
  .btn[data-active="true"]{ outline:2px solid var(--active-outline); outline-offset:1px }
  .sw{display:inline-block;width:16px;height:16px;border:1px solid rgba(0,0,0,.25);border-radius:3px}
  .sw.black{background:#1f2024} .sw.red{background:#b00000} .sw.white{background:#fff}

  .ink-control-group { position: relative; }
  .ink-slider-popup {
    display: none;
    position: absolute;
    bottom: calc(100% + 8px);
    left: 50%;
    transform: translateX(-50%);
    width: 56px;
    height: 160px;
    box-sizing: border-box;
    background: var(--panel-bg);
    backdrop-filter: blur(10px);
    border: 1px solid var(--panel-border);
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    z-index: 52;
    padding: 12px 0;
    flex-direction: column;
    align-items: center;
  }
  .ink-slider-popup.active { display: flex; }
  .slider-container {
    flex-grow: 1;
    position: relative;
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  input[type="range"].ink-slider {
    -webkit-appearance: none;
    appearance: none;
    background: transparent;
    cursor: pointer;
    width: 110px; /* This is the track length */
    transform: rotate(270deg);
  }
  input[type="range"].ink-slider::-webkit-slider-runnable-track {
    background: rgba(120, 120, 128, 0.36);
    height: 4px;
    border-radius: 2px;
  }
  input[type="range"].ink-slider::-moz-range-track {
    background: rgba(120, 120, 128, 0.36);
    height: 4px;
    border-radius: 2px;
  }
  input[type="range"].ink-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    margin-top: -8px; /* (thumb height - track height) / 2 */
    background: #fff;
    height: 20px;
    width: 20px;
    border-radius: 50%;
    border: 1px solid rgba(0,0,0,0.1);
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  }
  input[type="range"].ink-slider::-moz-range-thumb {
    background: #fff;
    height: 20px;
    width: 20px;
    border-radius: 50%;
    border: 1px solid rgba(0,0,0,0.1);
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  }
  .slider-value { font-size: 11px; color: var(--ui-text); text-align: center; }

  .stage{
    height:100vh;
    overflow:hidden;
    background:var(--stage-bg);
    position:relative;
    scrollbar-gutter:stable;
    display:flex;
    align-items:center;
    justify-content:center;
  }
  .stage::-webkit-scrollbar-horizontal{ height:0; }
  .stage:focus{ outline:none; }
  .zoom-wrap{ width:var(--stage-width-px); min-height:var(--stage-height-px); transform-origin: top center; will-change: transform; display:flex; justify-content:center; }
  .stage-inner{
    min-width:var(--stage-width-px);
    min-height:var(--stage-height-px);
    box-sizing:border-box;
    will-change: transform;
    transform: translate3d(0px,0px,0);
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:16px;
    padding:0;
  }
  .page-wrap{ width:calc(var(--page-w) * 1px); margin:0 auto 16px; position:relative; }
  .page{ width:100%; background:var(--page-bg); box-shadow:var(--page-shadow); position:relative; overflow:hidden; }
  .margin-box{ position:absolute; border:1px dashed rgba(0,0,0,0.25); pointer-events:none; visibility:hidden; }
  @media (prefers-color-scheme: dark){ :root:not([data-theme='light']) .margin-box{ border-color: rgba(255,255,255,0.35); } }
  :root[data-theme='dark'] .margin-box{ border-color: rgba(255,255,255,0.35); }
  body[data-page-tone='dark'] .margin-box{ border-color: rgba(255,255,255,0.35); }

  .ruler{ position:fixed; left:0; bottom:var(--toolbar-h); height:16px; z-index:50; display:block; overflow:hidden; pointer-events:none; width:var(--stage-width-px); }
  #rulerH_stops_container { position:absolute; inset:0; pointer-events:auto; }
  .ruler-ticks{ position:absolute; inset:0; background:var(--ruler-bg); border-top:1px solid var(--ruler-tick); box-sizing:border-box; }
  .tick{ position:absolute; bottom:0; width:1px; background:var(--ruler-tick); transform:translateZ(0) }
  .tick.major{ height:100% } .tick.medium{ height:60% } .tick.minor{ height:30% }
  .tick-num{ position:absolute; top:0; font-size:9px; line-height:9px; color:var(--ruler-tick); font-family:sans-serif; opacity:0.8 }
  .tri{ position:absolute; bottom:0; width:0; height:0; cursor:ew-resize; border-left:8px solid transparent; border-right:8px solid transparent; border-bottom:var(--tri-h) solid var(--tri-color); transform:translateX(-50%); filter:drop-shadow(0 0 1px #0004); z-index:2; user-select:none; outline:none; }
  .tri.right{border-bottom-color:var(--tri-red)}
  .ruler-v{ position:fixed; left:0; top:0; width:16px; z-index:50; display:block; overflow:hidden; pointer-events:none; height:var(--stage-height-px); }
  #rulerV_stops_container { position:absolute; inset:0; pointer-events:auto; }
  .ruler-v-ticks{ position:absolute; inset:0; background:var(--ruler-bg); border-right:1px solid var(--ruler-tick); box-sizing:border-box; }
  .tick-v{ position:absolute; right:0; height:1px; background:var(--ruler-tick); transform:translateZ(0) }
  .tick-v.major{ width:100% } .tick-v.medium{ width:60% } .tick-v.minor{ width:30% }
  .tick-v-num{ position:absolute; left:2px; font-size:9px; line-height:9px; color:var(--ruler-tick); font-family:sans-serif; opacity:0.8 }
  .tri-v{ position:absolute; left:0; width:0; height:0; cursor:ns-resize; border-top:8px solid transparent; border-bottom:8px solid transparent; border-left:var(--tri-h) solid var(--tri-color); transform:translateY(-50%); filter:drop-shadow(0 0 1px #0004); z-index:2; user-select:none; outline:none; }
  .tri-v.bottom{border-left-color:var(--tri-red)}
  .rulers-off .ruler, .rulers-off .ruler-v{ display:none !important; }

  .guide{ position:fixed; display:none; pointer-events:none; z-index:100; }
  #guideH{ left:0; right:0; height:0; border-top:1px dashed var(--tri-color); }
  #guideV{ top:0; bottom:0; width:0; border-left:1px dashed var(--tri-color); }

  .app-version{
    position:fixed;
    top:8px;
    left:12px;
    padding-left:8px;
    font-size:12px;
    font-family:system-ui, -apple-system, sans-serif;
    color:var(--ui-text);
    opacity:0.7;
    z-index:120;
    pointer-events:none;
  }

  .page canvas{ display:block; width:100%; height:auto; }
  .caret{ position:absolute; width:2px; background:var(--caret-color); pointer-events:none; animation:blink 1s steps(1) infinite; }
  @keyframes blink { 0%,49%{opacity:1} 50%,100%{opacity:0} }

  .side-panel {
    position: fixed;
    top: 0;
    bottom: var(--toolbar-h);
    width: 360px;
    background: var(--panel-bg);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    z-index: 100;
    transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
    font-family: system-ui, -apple-system, sans-serif;
    font-size: 13px;
    color: var(--ui-text);
  }

  html.safari-no-blur .side-panel,
  html.safari-no-blur .ink-slider-popup {
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
  }

  html.safari-no-blur .side-panel {
    background-color: rgba(247, 247, 247, 0.95);
  }

  html.safari-no-blur .ink-slider-popup {
    background-color: rgba(247, 247, 247, 0.95);
  }

  @media (prefers-color-scheme: dark) {
    html:not([data-theme='light']).safari-no-blur .side-panel {
      background-color: rgba(44, 44, 46, 0.95);
    }
    html:not([data-theme='light']).safari-no-blur .ink-slider-popup {
      background-color: rgba(60, 60, 62, 0.9);
    }
  }
  html[data-theme='dark'].safari-no-blur .side-panel {
    background-color: rgba(44, 44, 46, 0.95);
  }
  html[data-theme='dark'].safari-no-blur .ink-slider-popup {
    background-color: rgba(60, 60, 62, 0.9);
  }
  .side-panel.from-left {
    left: 0;
    border-right: 1px solid var(--panel-border);
    transform: translateX(-100%);
  }
  .side-panel.from-right {
    right: 0;
    border-left: 1px solid var(--panel-border);
    transform: translateX(100%);
  }
  .side-panel.is-open { transform: translateX(0); }
  .panel-content { padding: 20px; overflow-y: auto; height: 100%; box-sizing: border-box; }
  .side-panel h3 { font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; opacity: 0.6; margin: 0 0 8px; }
  .settings-group-new { display: flex; flex-direction: column; gap: 12px; }
  .divider { border: none; height: 1px; background: var(--divider-color); margin: 24px 0; }
  .control-row { display: flex; justify-content: space-between; align-items: center; }
  .control-row label { text-align: left; }
  .control-row span { text-align: left; font-weight: 500; }
  .side-panel .apply-btn { width: 80px; min-width: 80px; padding: 0 12px; }
  .side-panel input[type="number"], .side-panel select, .input-with-suffix { width: 110px; }
  .side-panel input[type="number"], .side-panel select {
    box-sizing: border-box;
    height: 28px;
    border: 1px solid var(--control-border);
    border-radius: 6px;
    padding: 0 8px;
    background: var(--control-bg);
    color: var(--ui-text);
    font-size: 13px;
  }
  .side-panel input[type="checkbox"] { margin-left: auto; display: block; }
  .appearance-group { display: flex; flex-direction: column; gap: 12px; }
  .appearance-options { display: flex; flex-direction: column; gap: 8px; }
  .appearance-options label { display: flex; align-items: center; gap: 8px; font-size: 13px; }
  .appearance-options input[type="radio"] { margin: 0; }
  .appearance-dark-toggle { display: flex; align-items: center; gap: 8px; font-size: 12px; opacity: 0.8; margin-left: 24px; }
  .appearance-dark-toggle input[type="checkbox"] { margin: 0; }
  .ink-settings-content h4 { margin: 0; font-size: 12px; text-transform: uppercase; letter-spacing: 0.4px; opacity: 0.75; }
  .ink-settings-content { --ink-heading-width: 160px; }
  .settings-section {
    border: 1px solid var(--panel-border);
    border-radius: 12px;
    overflow: hidden;
    background: rgba(255, 255, 255, 0.08);
  }
  html[data-theme='dark'] .settings-section {
    background: rgba(255, 255, 255, 0.05);
  }
  .settings-section + .settings-section { margin-top: 16px; }
  .settings-section summary {
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 12px;
    padding: 14px 16px;
    cursor: pointer;
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.45px;
    color: inherit;
    list-style: none;
  }
  .settings-section summary::-webkit-details-marker { display: none; }
  .settings-toggle-icon {
    width: 0;
    height: 0;
    border-top: 6px solid transparent;
    border-bottom: 6px solid transparent;
    border-left: 7px solid currentColor;
    opacity: 0.7;
    transition: transform 0.2s ease;
    transform-origin: center;
  }
  .settings-section[open] .settings-toggle-icon {
    transform: rotate(90deg);
  }
  .settings-summary-label { flex: 1; }
  .settings-section summary:focus-visible {
    outline: 2px solid var(--accent-color);
    outline-offset: -2px;
  }
  .settings-section-content {
    padding: 0 16px 16px;
    display: flex;
    flex-direction: column;
    gap: 16px;
  }
  .ink-section { padding: 12px 0; border-top: 1px solid rgba(0,0,0,0.08); }
  .ink-section:first-of-type { border-top: none; padding-top: 4px; }
  .ink-section-header { display: grid; grid-template-columns: var(--ink-heading-width) minmax(0, 1fr); column-gap: 12px; row-gap: 6px; margin-bottom: 8px; }
  .ink-section-topline { grid-column: 1 / span 2; display: flex; }
  .ink-section-toggle { display: inline-flex; align-items: center; gap: 8px; padding: 4px 0; border: none; background: none; color: inherit; font: inherit; cursor: pointer; text-align: left; justify-self: stretch; justify-content: flex-start; white-space: nowrap; }
  .ink-section-toggle:focus-visible { outline: 2px solid var(--accent-color); outline-offset: 2px; border-radius: 4px; }
  .ink-section-toggle-icon { display: inline-flex; width: 16px; justify-content: center; transition: transform 0.18s ease; transform: rotate(90deg); font-size: 16px; line-height: 1; }
  .ink-section-title { font-size: 12px; text-transform: uppercase; letter-spacing: 0.4px; opacity: 0.75; }
  .ink-section.is-collapsed .ink-section-toggle-icon { transform: rotate(0deg); }
  .ink-section.is-collapsed .ink-section-body { display: none; }
  .ink-section-controls { grid-column: 1 / span 2; display: grid; grid-template-columns: minmax(0, 1fr) auto; align-items: center; column-gap: 8px; }
  .ink-section-controls input[type="range"] { width: 100%; min-width: 0; }
  .ink-section-controls input[type="number"] { width: 64px; padding: 0 6px; }
  .ink-inline-controls { display: grid; grid-template-columns: minmax(0, 1fr) auto auto; align-items: center; column-gap: 6px; }
  .ink-inline-controls input[type="number"], .ink-inline-controls input[type="text"] { width: 56px; }
  .ink-inline-controls input[type="range"] { width: 100%; min-width: 0; }
  .ink-overall-row { display: grid; grid-template-columns: var(--ink-heading-width) minmax(0, 1fr); column-gap: 12px; row-gap: 6px; }
  .ink-overall-topline { grid-column: 1 / span 2; display: grid; grid-template-columns: var(--ink-heading-width) minmax(0, 1fr); align-items: center; column-gap: 12px; }
  .ink-overall-heading { display: flex; align-items: center; gap: 8px; }
  .ink-overall-topline-right { display: flex; justify-content: flex-end; align-items: center; gap: 8px; min-height: 0; }
  .ink-overall-controls { grid-column: 1 / span 2; display: grid; grid-template-columns: minmax(0, 1fr) auto; align-items: center; column-gap: 8px; }
  .ink-overall-controls input[type="range"] { width: 100%; min-width: 0; }
  .ink-overall-controls input[type="number"] { width: 64px; padding: 0 6px; }
  .ink-overall-spacer { width: 16px; display: inline-flex; flex: 0 0 16px; visibility: hidden; }
  .ink-settings-divider { margin: 16px 0; }
  .ink-section-body .control-row { margin-bottom: 6px; }
  .ink-subgroup { border-left: 2px solid rgba(0,0,0,0.06); padding-left: 10px; margin: 6px 0 10px; }
  .ink-subheading { font-size: 11px; font-weight: 600; opacity: 0.65; margin: 8px 0 6px; text-transform: uppercase; }
  .ink-array-item { border: 1px solid rgba(0,0,0,0.08); border-radius: 4px; padding: 8px; margin-bottom: 8px; }
  .ink-array-title { font-size: 11px; font-weight: 600; opacity: 0.7; margin-bottom: 6px; text-transform: uppercase; }
  .ink-section.is-disabled { opacity: 0.55; }
  .ink-section-apply-row .btn { margin-left: 12px; }
  .ink-seed-input { font-family: 'SFMono-Regular', 'SFMono', Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; }
  .ink-styles-section { margin-top: 20px; display: flex; flex-direction: column; gap: 12px; }
  .ink-style-save-row, .ink-style-io-row { display: flex; gap: 8px; align-items: center; }
  .ink-style-save-row input[type="text"] {
    flex: 1 1 auto;
    min-width: 0;
    height: 28px;
    border-radius: 6px;
    border: 1px solid var(--control-border);
    padding: 0 8px;
    background: var(--control-bg);
    color: var(--ui-text);
    font-size: 13px;
  }
  .ink-style-save-row input[type="text"].input-error { border-color: var(--danger-border, #c24141); }
  .ink-style-save-row .btn { white-space: nowrap; }
  .ink-style-io-row { justify-content: flex-start; }
  .ink-style-io-row .btn { flex: 0 0 auto; }
  .ink-styles-list { display: flex; flex-direction: column; gap: 8px; }
  .ink-styles-empty { font-size: 12px; opacity: 0.6; }
  .ink-style-item {
    border: 1px solid var(--panel-border);
    border-radius: 8px;
    padding: 10px 12px;
    background: var(--panel-item-bg);
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  .ink-style-item.is-active { border-color: var(--accent-color); box-shadow: 0 0 0 1px var(--accent-color); }
  .ink-style-name-row { display: flex; align-items: center; min-width: 0; }
  .ink-style-name-input {
    background: none;
    border: 1px solid transparent;
    border-radius: 6px;
    color: var(--ui-text);
    font-size: 13px;
    font-weight: 600;
    width: 100%;
    min-width: 0;
    padding: 2px 6px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .ink-style-name-input:focus-visible {
    outline: 2px solid var(--accent-color);
    outline-offset: 1px;
  }
  .ink-style-name-input.input-error { border-color: var(--danger-border, #c24141); }
  .ink-style-actions-row { display: flex; flex-wrap: wrap; gap: 12px; align-items: center; }
  .ink-style-actions-row .btn-text {
    font-size: 12px;
    padding: 0;
    background: none;
    border: none;
    color: var(--accent-color);
    cursor: pointer;
    font: inherit;
  }
  .ink-style-actions-row .btn-text.danger { color: var(--danger-color, #c24141); }
  .ink-style-actions-row .btn-text:focus-visible { outline: 2px solid var(--accent-color); outline-offset: 2px; }
  .input-with-suffix { position: relative; display: flex; }
  .input-with-suffix input { width: 100%; }
  .input-with-suffix span { position: absolute; right: 8px; top: 50%; transform: translateY(-50%); pointer-events: none; opacity: 0.5; }
  #typographySettings .range-input-pair { display: flex; align-items: center; gap: 8px; }
  #typographySettings .range-input-pair .input-with-suffix { width: 88px; }
  #typographySettings .range-input-pair .range-separator { font-weight: 600; opacity: 0.6; }

  .fonts-settings-group { gap: 8px; }
  .fonts-settings-group .font-option {
    display: block;
    cursor: pointer;
    padding: 12px;
    border-radius: 8px;
    border: 1px solid var(--panel-border);
    background: var(--panel-item-bg);
  }
  .fonts-settings-group .font-option-header {
    display: flex;
    align-items: center;
  }
  .fonts-settings-group .font-name {
    font-size: 14px;
    margin-left: 8px;
  }
  .fonts-settings-group .font-sample {
    font-size: 16px;
    line-height: 1;
    white-space: nowrap;
    display: block;
    margin-top: 8px;
    opacity: 0.8;
  }

  .zoom-controls{ position:fixed; right:0px; top:16px; display:flex; flex-direction:column; align-items:center; gap:8px; z-index:52; }
  .slider{ position:relative; width:60px; height:calc(122px + 2px + 14px); pointer-events:none; }
  .track{ position:absolute; top:0; left:50%; transform:translateX(-50%); width:4.1px; height:122px; border:1px solid var(--tri-color); border-radius:35px; background:transparent; overflow:hidden; pointer-events:none; }
  .fill{ position:absolute; left:0; right:0; bottom:0; height:0; background:var(--tri-color); pointer-events:none; will-change:height; }
  .thumb{ position:absolute; left:50%; transform:translateX(-50%); width:13px; height:13px; border-radius:50%; background:var(--tri-color); pointer-events:auto; touch-action:none; cursor:ns-resize; }
  .thumb:active{ filter:brightness(0.97); }
  #zoomIndicator{ background:var(--btn-bg); color:var(--btn-fg); padding:2px 6px; border-radius:4px; font-size:12px; font-family:sans-serif; border:1px solid var(--btn-border); opacity:0; transition:opacity 0.4s ease-out; pointer-events:none; }
  #zoomIndicator.show{ opacity:1; transition-duration:0.1s; }
